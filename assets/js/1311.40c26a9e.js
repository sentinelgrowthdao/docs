"use strict";(self.webpackChunksentinel_docs=self.webpackChunksentinel_docs||[]).push([[1311],{24613:(e,t,i)=>{i.d(t,{d:()=>s,e:()=>n,f:()=>a});const s=(e,t)=>{const i=t.getTime()-e.getTime();return Math.round(Math.abs(i/1e3/60))},n=(e,t)=>{const i=s(e,t);if(i<2)return"just now";if(i<60)return`${i}m ago`;const n=Math.round(i/60);if(i<90)return`about ${n}h ago`;if(n<24)return`${n}h ago`;const a=Math.round(n/24);if(a<7)return`${a}d ago`;return`${Math.round(a/7)}w ago`},a=e=>e.toDateString()+" "+e.toLocaleTimeString()},91364:(e,t,i)=>{i.d(t,{d:()=>b});var s=i(49583),n="[object Symbol]";var a=/\s/;var o=/^\s+/;function r(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&a.test(e.charAt(t)););return t}(e)+1).replace(o,""):e}var d=NaN,c=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,p=parseInt;function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||(0,s.i)(e)&&(0,s.b)(e)==n}(e))return d;if((0,s.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,s.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var i=l.test(e);return i||h.test(e)?p(e.slice(2),i?2:8):c.test(e)?d:+e}var u=function(){return s.r.Date.now()},m="Expected a function",v=Math.max,y=Math.min;function b(e,t,i){var n,a,o,r,d,c,l=0,h=!1,p=!1,b=!0;if("function"!=typeof e)throw new TypeError(m);function f(t){var i=n,s=a;return n=a=void 0,l=t,r=e.apply(s,i)}function w(e){var i=e-c;return void 0===c||i>=t||i<0||p&&e-l>=o}function x(){var e=u();if(w(e))return k(e);d=setTimeout(x,function(e){var i=t-(e-c);return p?y(i,o-(e-l)):i}(e))}function k(e){return d=void 0,b&&n?f(e):(n=a=void 0,r)}function _(){var e=u(),i=w(e);if(n=arguments,a=this,c=e,i){if(void 0===d)return function(e){return l=e,d=setTimeout(x,t),h?f(e):r}(c);if(p)return clearTimeout(d),d=setTimeout(x,t),f(c)}return void 0===d&&(d=setTimeout(x,t)),r}return t=g(t)||0,(0,s.a)(i)&&(h=!!i.leading,o=(p="maxWait"in i)?v(g(i.maxWait)||0,t):o,b="trailing"in i?!!i.trailing:b),_.cancel=function(){void 0!==d&&clearTimeout(d),l=0,n=c=a=d=void 0},_.flush=function(){return void 0===d?r:k(u())},_}},91311:(e,t,i)=>{i.r(t),i.d(t,{dyte_channel_header:()=>y,dyte_channel_selector_view:()=>b,dyte_chat_composer_view:()=>w,dyte_chat_messages_ui:()=>x,dyte_chat_messages_ui_paginated:()=>k,dyte_chat_search_results:()=>_,dyte_dialog_manager:()=>C,dyte_notifications:()=>j});var s=i(72944),n=i(26468),a=(i(86824),i(26786)),o=i(17073),r=i(84593),d=i(55055),c=i(91364),l=i(8327),h=i(24613),p=i(32599),g=i(50975),u=i(17213),m=i(98724),v=i(1821);i(50057),i(54956),i(49583);const y=class{constructor(e){(0,s.r)(this,e),this.search=(0,s.c)(this,"search",7),this.searchDismissed=(0,s.c)(this,"searchDismissed",7),this.back=(0,s.c)(this,"back",7),this.meeting=void 0,this.channel=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.showChannelDetailsDialog=!1,this.showSearchBar=!1,this.members=[],this.showBackButton=!1}onChannelChanged(){this.$searchInput&&(this.$searchInput.value=""),this.showSearchBar=!1,this.channel.isDirectMessage||this.meeting.chat.getChannelMembers(this.channel.id).then((e=>{this.members=e}))}connectedCallback(){this.onChannelChanged()}renderChannelDetails(){return(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showChannelDetailsDialog=!1},iconPack:this.iconPack,t:this.t},(0,s.h)("dyte-channel-details",{members:this.members,channel:this.channel}))}render(){return this.channel?(0,s.h)(s.H,null,this.showChannelDetailsDialog&&this.renderChannelDetails(),(0,s.h)("header",{class:{searching:this.showSearchBar}},this.showBackButton&&(0,s.h)("dyte-button",{kind:"icon",variant:"secondary",class:"back-btn",onClick:()=>{this.back.emit()}},(0,s.h)("dyte-icon",{icon:this.iconPack.chevron_left})),(0,s.h)("div",{class:"channel-details"},(0,s.h)("span",{class:"name"},this.channel.displayName),!this.channel.isDirectMessage&&(0,s.h)("span",{class:"members"},this.members.map((e=>e.name)).join(", "))),(0,s.h)("div",{class:"channel-tools"},!this.channel.isDirectMessage&&(0,s.h)("dyte-tooltip",{label:this.t("chat.channel_members"),iconPack:this.iconPack,t:this.t,variant:"primary"},(0,s.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"button",variant:"secondary",size:"md",onClick:()=>{this.showChannelDetailsDialog=!this.showChannelDetailsDialog},class:"br-primary-btn"},(0,s.h)("dyte-icon",{icon:this.iconPack.people,iconPack:this.iconPack,t:this.t})))))):null}static get watchers(){return{channel:["onChannelChanged"]}}};y.style="header{box-sizing:border-box;height:var(--dyte-space-16, 64px);width:100%;padding:var(--dyte-space-4, 16px);display:flex;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}header.searching{justify-content:flex-end}header.searching .channel-details{display:none}header .channel-details{display:flex;flex-grow:1;flex-direction:column;justify-content:center;height:var(--dyte-space-9, 36px);width:var(--dyte-space-1, 4px)}header .channel-details .name{font-weight:500}header .channel-details .members{margin-top:var(--dyte-space-0\\.5, 2px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}header .channel-tools{display:flex;flex-shrink:0;justify-content:flex-end;gap:var(--dyte-space-1, 4px);min-width:var(--dyte-space-24, 96px)}header .channel-tools dyte-tooltip{height:var(--dyte-space-8, 32px);width:var(--dyte-space-10, 40px);display:flex}header .search-input{height:var(--dyte-space-8, 32px);width:var(--dyte-space-48, 192px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header .name{font-size:16px}header .br-primary-btn{background-color:transparent}header .br-primary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}@media (orientation: landscape) and (min-width: 400px){header.searching .channel-details{display:flex}}.back-btn{margin-right:var(--dyte-space-3, 12px)}";const b=class{constructor(e){(0,s.r)(this,e),this.channelChange=(0,s.c)(this,"channelChange",7),this.calculateListHeight=(0,c.d)((()=>{if("list"===this.viewAs&&this.$listEl){let e=0;const t=this.$el.shadowRoot.querySelector('slot[name="header"]');t&&t.assignedElements().forEach((t=>e+=t.offsetHeight)),this.$searchEl&&(e+=this.$searchEl.offsetHeight),this.$listEl.style.height=window.innerHeight-e-16+"px"}}),60),this.getFilteredChannels=()=>""===this.searchQuery.trim()?this.channels:this.channels.filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),this.toggleDropdown=()=>{this.showDropdown=!this.showDropdown},this.getChannelById=e=>this.channels.find((t=>t.id===e)),this.getTotalUnreads=()=>this.channels.reduce(((e,t)=>e+t.unreadCount),0),this.onChannelClickHandler=e=>{this.channelChange.emit(e),"dropdown"===this.viewAs&&(this.showDropdown=!1)},this.channels=void 0,this.selectedChannelId=void 0,this.disableSearch=!1,this.hideAvatar=!1,this.iconPack=o.d,this.t=(0,r.u)(),this.viewAs="list",this.searchQuery="",this.showDropdown=!1}connectedCallback(){this.resizeObserver=new ResizeObserver(this.calculateListHeight)}componentDidLoad(){this.resizeObserver.observe(this.$el),this.calculateListHeight()}disconnectedCallback(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.calculateListHeight.cancel()}getTimeLabel(e){const t=new Date,i=new Date(t);i.setDate(t.getDate()-1);const s=new Date(t);if(s.setDate(t.getDate()-t.getDay()-1),e.toDateString()===t.toDateString())return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(e.toDateString()===i.toDateString())return this.t("date.yesteday");if(e>s){const t=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"];return this.t(t[e.getDay()])}return Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(e)}render(){const e=this.getFilteredChannels(),t="list"===this.viewAs||"dropdown"===this.viewAs&&this.showDropdown;return(0,s.h)(s.H,null,"list"===this.viewAs&&(0,s.h)("slot",{name:"header"}),t&&(0,s.h)("div",{class:{dropdown:"dropdown"===this.viewAs,scrollbar:"dropdown"===this.viewAs,list:"list"===this.viewAs}},!this.disableSearch&&(0,s.h)("div",{class:"search-container",ref:e=>this.$searchEl=e},(0,s.h)("input",{type:"text",placeholder:this.t("chat.search_conversations"),value:this.searchQuery,onInput:e=>this.searchQuery=e.target.value}),(0,s.h)("dyte-icon",{icon:this.iconPack.search})),(0,s.h)("div",{class:"channels-container scrollbar",ref:e=>this.$listEl=e},e.map((e=>(0,s.h)("button",{class:{channel:!0,active:this.selectedChannelId===e.id},onClick:()=>this.onChannelClickHandler(e)},!this.hideAvatar&&(0,s.h)("div",null,e.icon?(0,s.h)("dyte-icon",{class:"avatar-icon",icon:this.iconPack[e.icon]}):(0,s.h)("dyte-avatar",{participant:{name:e.name,picture:e.avatarUrl}})),(0,s.h)("div",{class:"channel-data"},(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"name"},e.name),e.latestMessage&&(0,s.h)("div",{class:{"last-message":!0,"no-message":!e.latestMessage}},(0,s.h)("dyte-text-message-view",{isMarkdown:!0,text:e.latestMessage}))),(0,s.h)("div",{class:"col channel-meta"},e.latestMessageTime&&(0,s.h)("time",{class:"time"},this.getTimeLabel(e.latestMessageTime)),e.unreadCount>0&&(0,s.h)("div",{class:"unread-count"},e.unreadCount)))))))),"dropdown"===this.viewAs&&(0,s.h)("button",{class:"dropdown-trigger",onClick:this.toggleDropdown},(0,s.h)("span",null,this.selectedChannelId&&`${this.t("to")} ${this.getChannelById(this.selectedChannelId).name}`,this.getTotalUnreads()>0&&(0,s.h)("div",{class:"unread-count"},this.getTotalUnreads())),(0,s.h)("dyte-icon",{icon:this.showDropdown?this.iconPack.chevron_up:this.iconPack.chevron_down})))}get $el(){return(0,s.a)(this)}};b.style=".scrollbar {\n  /* For Firefox */\n  scrollbar-width: thin;\n  scrollbar-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent);\n}\n\n/* For WebKit */\n.scrollbar::-webkit-scrollbar {\n  height: var(--dyte-space-1\\.5, 6px);\n  width: var(--dyte-space-1\\.5, 6px);\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-background, transparent);\n}\n\n.scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)));\n}\n\n\n:host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  position: relative;\n  z-index: 10;\n  height: var(--dyte-space-12, 48px);\n  min-height: 48px;\n}\n\n.dropdown-trigger {\n  height: 100%;\n  width: 100%;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  padding: var(--dyte-space-4, 16px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n  font-size: 14px;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  cursor: pointer;\n  position: absolute;\n  z-index: 20;\n}\n\n.dropdown-trigger span {\n  display: flex;\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.dropdown-trigger dyte-icon {\n  margin-left: var(--dyte-space-1, 4px);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  flex-shrink: 0;\n}\n\n@container chatcontainer (height < 360px) {\n  .dropdown-trigger {\n    padding: var(--dyte-space-2, 8px);\n  }\n  .dropdown {\n    top: var(--dyte-space-8, 32px) !important;\n  }\n  .search-container {\n    padding-left: var(--dyte-space-0, 0px) !important;\n    padding-right: var(--dyte-space-0, 0px) !important;\n    padding-top: var(--dyte-space-0, 0px) !important;\n    padding-bottom: var(--dyte-space-0, 0px) !important;\n  }\n  input {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-none, 0) !important;\n  }\n  .channel {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-sm, 4px) !important;\n  }\n  .avatar-icon {\n    height: var(--dyte-space-3, 12px) !important;\n    width: var(--dyte-space-3, 12px) !important;\n    padding: var(--dyte-space-1, 4px) !important;\n  }\n\n  dyte-avatar {\n    height: var(--dyte-space-5, 20px) !important;\n    width: var(--dyte-space-5, 20px) !important;\n  }\n}\n\n.dropdown {\n  position: absolute;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  top: var(--dyte-space-12, 48px);\n  z-index: 10;\n  animation: 0.3s slide-down ease;\n}\n\n.dropdown .channels-container {\n  max-height: var(--dyte-space-80, 320px);\n}\n\n.list {\n  display: flex;\n  flex-direction: column;\n}\n\n.list .channel .channel-data {\n  align-items: flex-start;\n}\n\n.unread-count {\n  display: flex;\n  justify-content: center;\n  height: var(--dyte-space-5, 20px);\n  min-width: var(--dyte-space-3, 12px);\n  border-radius: 9999px;\n  padding-left: var(--dyte-space-1, 4px);\n  padding-right: var(--dyte-space-1, 4px);\n  font-size: 12px;\n  line-height: 1.25rem;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\ninput {\n  height: var(--dyte-space-9, 36px);\n  width: 100%;\n  padding-left: var(--dyte-space-3, 12px);\n  padding-right: var(--dyte-space-3, 12px);\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.search-container {\n  display: flex;\n  flex-shrink: 0;\n  flex-grow: 0;\n  flex-basis: auto;\n  align-items: center;\n  padding-top: var(--dyte-space-3, 12px);\n  padding-bottom: var(--dyte-space-3, 12px);\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-2, 8px);\n  border-bottom: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.search-container dyte-icon {\n  margin-left: calc(var(--dyte-space-8, 32px) * -1);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channels-container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--dyte-space-1, 4px);\n  padding: var(--dyte-space-2, 8px);\n  flex: 1 1 auto;\n  overflow-y: auto;\n}\n\n.channel {\n  flex-shrink: 0;\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  background-color: transparent;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  cursor: pointer;\n  border-radius: var(--dyte-border-radius-md, 8px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: var(--dyte-space-2, 8px);\n  height: var(--dyte-space-16, 64px);\n  width: 100%;\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  transition-property: color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.channel:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n}\n\n.channel .channel-data {\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.channel .name {\n  font-size: 16px;\n}\n\n.channel .name, \n  .channel .last-message {\n  max-width: var(--dyte-space-40, 160px);\n  text-align: left;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n}\n\n.channel .no-message {\n  font-style: italic;\n}\n\n.channel dyte-avatar {\n  height: var(--dyte-space-12, 48px);\n  width: var(--dyte-space-12, 48px);\n  overflow: clip;\n  border-radius: 9999px;\n  font-size: 14px;\n}\n\n.channel .avatar-icon {\n  height: var(--dyte-space-6, 24px);\n  width: var(--dyte-space-6, 24px);\n  padding: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n  overflow: clip;\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n.channel time, \n  .channel .last-message {\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channel.active {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.channel.active .unread-count {\n  background-color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));\n}\n\n.channel.active time {\n  color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n}\n\n.channel.active .last-message {\n  color: rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)));\n}\n\n.channel.active dyte-avatar {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.col {\n  gap: var(--dyte-space-1, 4px);\n  display: flex;\n  flex-direction: column;\n}\n\n.channel-meta {\n  flex-shrink: 0;\n  align-items: flex-end;\n}\n\n@keyframes slide-down {\n  from {\n    transform: translateY(-50px);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";const f={messagesSent:0,startTime:0},w=class{constructor(e){(0,s.r)(this,e),this.onNewMessage=(0,s.c)(this,"newMessage",7),this.onEditMessage=(0,s.c)(this,"editMessage",7),this.onEditCancel=(0,s.c)(this,"editCancel",7),this.onQuotedMessageDismiss=(0,s.c)(this,"quotedMessageDismiss",7),this.textMessage="",this.sendFile=()=>{this.canSendFiles&&("image"===this.fileToUpload.type?this.onNewMessage.emit({type:"image",image:this.fileToUpload.file}):this.onNewMessage.emit({type:"file",file:this.fileToUpload.file}),this.fileToUpload=null)},this.handleSendMessage=()=>{if(!this.canSendTextMessage||this.rateLimitsBreached)return;if(null!==this.fileToUpload)return void this.sendFile();const e=this.textMessage,t=Date.now();t-f.startTime>1e3*this.rateLimits.period&&(f.startTime=t,f.messagesSent=0),f.messagesSent+=1,this.checkRateLimitBreached(t),e.length>0&&(this.quotedMessage.length,this.onNewMessage.emit({type:"text",message:e}),this.cleanup())},this.handleEditMessage=()=>{this.onEditMessage.emit(this.textMessage),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancel.emit(),this.cleanup()},this.onTextChangeHandler=e=>{var t;this.textMessage=e.detail,this.textMessage.length>=(null!==(t=this.maxLength)&&void 0!==t?t:l.M)?this.disableSendButton=!0:this.disableSendButton&&(this.disableSendButton=!1),d.a.setItem(this.storageKey,e.detail)},this.onKeyDownHandler=e=>{"Enter"===e.key&&e.shiftKey||this.disableSendButton||"Enter"===e.key&&(e.preventDefault(),this.isEditing?this.handleEditMessage():this.handleSendMessage())},this.onFileUploadHandler=(e,t)=>{this.fileToUpload={type:e,file:t}},this.onQuotedMessageDismissHandler=()=>{this.onQuotedMessageDismiss.emit()},this.cleanup=()=>{this.textMessage="",this.fileToUpload=null,d.a.setItem(this.storageKey,""),this.$textComposer.setText("",!0),this.isEmojiPickerOpen=!1},this.canSendTextMessage=!0,this.canSendFiles=!0,this.message="",this.quotedMessage="",this.storageKey="dyte-text-message",this.inputTextPlaceholder="Enter your message",this.isEditing=!1,this.iconPack=o.d,this.t=(0,r.u)(),this.maxLength=void 0,this.disableEmojiPicker=!1,this.rateLimits={period:60,maxInvocations:60},this.fileToUpload=null,this.isEmojiPickerOpen=!1,this.disableSendButton=!1,this.rateLimitsBreached=!1,this.onKeyDownHandler=this.onKeyDownHandler.bind(this)}connectedCallback(){this.textMessage=this.message||d.a.getItem(this.storageKey)||"",this.checkRateLimitBreached(Date.now())}componentWillUpdate(){this.textMessage=this.message||d.a.getItem(this.storageKey)||""}componentDidLoad(){this.message&&(0,s.w)((()=>this.$textComposer.setText(this.message,!0)))}checkRateLimitBreached(e){if(f.messagesSent>=this.rateLimits.maxInvocations){this.disableSendButton=!0,this.rateLimitsBreached=!0;const t=e-f.startTime+1e3*this.rateLimits.period;setTimeout((()=>{f.messagesSent=0,f.startTime=Date.now(),this.disableSendButton=!1,this.rateLimitsBreached=!1}),t)}}render(){var e;const t={iconPack:this.iconPack,t:this.t};return(0,s.h)(s.H,null,this.canSendTextMessage&&this.isEmojiPickerOpen&&(0,s.h)("dyte-emoji-picker",Object.assign({part:"emoji-picker",onPickerClose:()=>{this.isEmojiPickerOpen=!1},onDyteEmojiClicked:e=>{this.textMessage+=e.detail,this.$textComposer.setText(this.textMessage,!0)}},t)),(0,s.h)("slot",{name:"chat-addon"}),this.quotedMessage&&0!==this.quotedMessage.length&&(0,s.h)("div",{class:"quoted-message-container",part:"quoted-message-container"},(0,s.h)("div",{class:"quoted-message scrollbar"},(0,s.h)("dyte-text-message-view",{text:this.quotedMessage,isMarkdown:!0})),(0,s.h)("div",null,(0,s.h)("dyte-icon",Object.assign({"aria-label":this.t("dismiss"),class:"dismiss",icon:this.iconPack.dismiss,onClick:this.onQuotedMessageDismissHandler},t)))),(0,s.h)("div",{class:"composer-container"},(0,s.h)("div",{class:"composers"},this.fileToUpload&&(0,s.h)("dyte-draft-attachment-view",Object.assign({},t,{attachment:this.fileToUpload,onDeleteAttachment:()=>this.fileToUpload=null})),!this.fileToUpload&&(0,s.h)("dyte-text-composer-view",{value:this.textMessage,placeholder:this.inputTextPlaceholder,onTextChange:this.onTextChangeHandler,keyDownHandler:this.onKeyDownHandler,maxLength:null!==(e=this.maxLength)&&void 0!==e?e:l.M,rateLimitBreached:this.rateLimitsBreached,t:this.t,iconPack:this.iconPack,ref:e=>this.$textComposer=e})),(0,s.h)("div",{class:"chat-buttons",part:"chat-buttons"},(0,s.h)("div",{class:"left",part:"chat-buttons-left"},!this.fileToUpload&&!this.isEditing&&(0,s.h)("div",null,this.canSendFiles&&[(0,s.h)("dyte-file-picker-button",Object.assign({},t,{onFileChange:e=>this.onFileUploadHandler("file",e.detail)})),(0,s.h)("dyte-file-picker-button",Object.assign({filter:"image/*",label:this.t("chat.send_img"),icon:"image",onFileChange:e=>this.onFileUploadHandler("image",e.detail)},t))],this.canSendTextMessage&&!this.disableEmojiPicker&&(0,s.h)("dyte-emoji-picker-button",Object.assign({isActive:this.isEmojiPickerOpen,onClick:()=>{this.isEmojiPickerOpen=!this.isEmojiPickerOpen}},t)),(0,s.h)("slot",{name:"chat-buttons"}))),(0,s.h)("div",{class:"right",part:"chat-buttons-right"},!this.isEditing&&(0,s.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.send_msg"),delay:2e3},t),(0,s.h)("dyte-button",Object.assign({kind:"icon",disabled:this.disableSendButton,onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg")},t),(0,s.h)("dyte-icon",{icon:this.iconPack.send}))),this.isEditing&&(0,s.h)("div",{class:"edit-buttons"},(0,s.h)("dyte-tooltip",Object.assign({variant:"secondary",label:this.t("cancel"),delay:2e3},t),(0,s.h)("dyte-button",Object.assign({kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel")},t),(0,s.h)("dyte-icon",{icon:this.iconPack.dismiss}))),(0,s.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.update_msg"),delay:2e3},t),(0,s.h)("dyte-button",Object.assign({kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg")},t),(0,s.h)("dyte-icon",{icon:this.iconPack.checkmark}))))))))}};w.style=":host {\n  display: flex;\n  flex-direction: column;\n  font-family: var(--dyte-font-family, sans-serif);\n  font-size: 14px;\n  position: relative;\n}\n\n.quoted-message-container {\n  margin-bottom: var(--dyte-space-2, 8px);\n  display: flex;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.quoted-message-container .quoted-message {\n  flex: 1 1 0%;\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  max-height: var(--dyte-space-24, 96px);\n  overflow-y: auto;\n  word-break: break-all;\n}\n\n.quoted-message-container .quoted-message blockquote {\n  display: none;\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  margin-left: auto;\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  color: rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));\n}\n\n.quoted-message-container dyte-icon.dismiss:hover {\n  cursor: pointer;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  transition-property: color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.composer-container {\n  position: relative;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  overflow: hidden;\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.composer-container > .composers {\n    min-height: 60px;\n  }\n\n@container chatcontainer (height < 360px) {\n    .composer-container > .composers {\n      min-height: 30px;\n    }\n}\n\n.chat-buttons {\n  padding: var(--dyte-space-3, 12px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.chat-buttons .right {\n  z-index: 10;\n}\n\n.chat-buttons .right .edit-buttons {\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.chat-buttons > div {\n  display: flex;\n  align-items: center;\n}\n\ndyte-emoji-picker {\n  z-index: 20;\n  position: absolute;\n  top: calc(var(--dyte-space-72, 288px) * -1);\n  border-top: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n  animation: 0.3s slide-up ease;\n}\n\n@keyframes slide-up {\n  from {\n    transform: translateY(100%);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";const x=class{constructor(e){(0,s.r)(this,e),this.onPinMessage=(0,s.c)(this,"pinMessage",7),this.stateUpdate=(0,s.c)(this,"dyteStateUpdate",7),this.observingEl=[],this.autoScrollEnabled=!0,this.onScroll=e=>{const t=e.target;(0,s.w)((()=>{const{scrollTop:e,clientHeight:i,scrollHeight:s}=t;e+i+10>=s?(this.autoScrollEnabled=!0,this.showLatestMessageButton=!1):this.autoScrollEnabled=!1}))},this.scrollToBottom=()=>{(0,p.s)(this.$chat)},this.observeMessage=e=>{e&&this.observingEl.push(e);try{this.intersectionObserver.observe(e)}catch(t){}},this.getMessageActions=e=>{const t=[];return!e.pinned&&this.canPinMessages&&t.push({id:"pin_message",label:this.t("pin"),icon:this.iconPack.pin}),t},this.onMessageActionHandler=(e,t)=>{if("pin_message"===e)this.onPinMessage.emit(t)},this.selectedGroup=void 0,this.messages=[],this.selfUserId=void 0,this.canPinMessages=!1,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.now=new Date,this.showLatestMessageButton=!1}connectedCallback(){var e;this.lastReadTimestamp=null!==(e=d.c.everyone)&&void 0!==e?e:new Date("0001-01-01T00:00:00Z"),this.intersectionObserver=new IntersectionObserver((e=>{document.hasFocus()&&(0,s.w)((()=>{for(const t of e)if(t.isIntersecting){parseInt(t.target.getAttribute("data-timestamp"))>this.lastReadTimestamp.getTime()&&(d.c[this.selectedGroup]=new Date)}}))}));const t=()=>{this.now=new Date,this.timeout=setTimeout((()=>{null!=this.request&&(this.request=requestAnimationFrame(t))}),6e4)};this.request=requestAnimationFrame(t),this.chatChanged(this.messages)}componentDidLoad(){this.$chat.addEventListener("scroll",this.onScroll),this.$chat.scrollTop=this.$chat.scrollHeight}componentDidRender(){this.autoScrollEnabled?(0,p.s)(this.$chat):null==this.autoScrollEnabled&&(0,p.s)(this.$chat,!1)}chatChanged(e){if(null!=this.$chat&&!this.autoScrollEnabled&&this.$chat.clientHeight!==this.$chat.scrollHeight)for(let t=e.length-1;t>=0;t--)if(e[t].message.time>this.lastReadTimestamp&&e[t].message.userId!==this.selfUserId){this.showLatestMessageButton=!0;break}}selectedBucketChanged(){this.autoScrollEnabled=void 0,this.observingEl.forEach((e=>{this.intersectionObserver.unobserve(e)})),this.observingEl=[]}disconnectedCallback(){this.$chat.removeEventListener("scroll",this.onScroll),this.intersectionObserver.disconnect(),clearTimeout(this.timeout),cancelAnimationFrame(this.request)}render(){var e;let t=null,i=!1;return(0,s.h)(s.H,null,(0,s.h)("div",{class:"chat-container scrollbar",ref:e=>this.$chat=e,part:"container"},(0,s.h)("div",{class:"spacer",part:"spacer"}),(0,s.h)("div",{class:"chat",part:"chat"},null===(e=this.messages)||void 0===e?void 0:e.map((e=>{if("chat"===e.type){const{message:a}=e,o=!(a.userId===this.selfUserId)&&!this.autoScrollEnabled&&!i&&a.time>this.lastReadTimestamp;o&&(i=o);const r=!o&&a.userId===(null==t?void 0:t.userId)&&(0,h.d)(a.time,null==t?void 0:t.time)<2;return t=a,(0,s.h)("div",{"is-continued":r,key:e.message.id,ref:this.observeMessage,"data-timestamp":a.time.getTime(),class:a.pinned?"pinned":""},o&&(0,s.h)("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),(0,s.h)("div",{class:"message-wrapper"},(0,s.h)("dyte-message-view",{time:a.time,actions:this.getMessageActions(a),authorName:a.displayName,hideAuthorName:!0,hideAvatar:!0,hideMetadata:!0,viewType:"incoming",variant:"bubble",onAction:e=>this.onMessageActionHandler(e.detail,a)},(0,s.h)("div",null,!r&&(0,s.h)("div",{class:"head"},(0,s.h)("div",{class:"name"},a.displayName),!!a.time&&(0,s.h)("div",{class:"time",title:(0,h.f)(a.time)},(0,h.e)(a.time,new Date(Date.now())))),(0,s.h)("div",{class:"body"},"text"===a.type&&(0,s.h)("dyte-text-message-view",{text:a.message,isMarkdown:!0}),"file"===a.type&&(0,s.h)("dyte-file-message-view",{name:a.name,url:a.link,size:a.size}),"image"===a.type&&(0,s.h)("dyte-image-message-view",{url:a.link,onPreview:()=>{this.stateUpdate.emit({image:a}),n.s.image=a}})))),a.pinned&&(0,s.h)("div",{class:"pin-button",part:"pin-button"},(0,s.h)("dyte-tooltip",{label:this.t("unpin"),iconPack:this.iconPack,t:this.t},(0,s.h)("dyte-button",{kind:"icon",variant:"ghost",onClick:()=>this.onMessageActionHandler("pin_message",a),iconPack:this.iconPack,t:this.t,disabled:!this.canPinMessages},(0,s.h)("dyte-icon",{icon:this.iconPack.pin,iconPack:this.iconPack,t:this.t,size:"sm"}))))))}return null})))),(0,s.h)("div",{class:"show-new-messages-ctr"},(0,s.h)("dyte-button",{class:{"show-new-messages":!0,active:this.showLatestMessageButton},kind:"icon",part:"show-new-messages",onClick:this.scrollToBottom,iconPack:this.iconPack,t:this.t},(0,s.h)("dyte-icon",{icon:this.iconPack.chevron_down,iconPack:this.iconPack,t:this.t}))))}static get watchers(){return{messages:["chatChanged"],selectedGroup:["selectedBucketChanged"]}}};x.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));word-break:break-word}.chat-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll}.chat-container .spacer{flex:1 1 auto}.chat-container .chat{flex:0 0 auto}.file-picker{display:none}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);overflow-wrap:break-word;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-message-view{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}dyte-message-view::part(message){flex-grow:1}*[is-continued] dyte-message-view{margin-top:var(--dyte-space-1, 4px)}.pinned .message-wrapper{position:relative}.pinned .pin-button{position:absolute;right:var(--dyte-space-4, 16px);top:calc(var(--dyte-space-4, 16px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.pinned .pin-button:hover dyte-button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));-webkit-text-decoration-line:none;text-decoration-line:none}a:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:var(--dyte-space-16, 64px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}";const k=class{constructor(e){(0,s.r)(this,e),this.editMessageInit=(0,s.c)(this,"editMessageInit",7),this.onPinMessage=(0,s.c)(this,"pinMessage",7),this.onDeleteMessage=(0,s.c)(this,"deleteMessage",7),this.stateUpdate=(0,s.c)(this,"dyteStateUpdate",7),this.pageSize=25,this.lastReadMessageIndex=-1,this.permissionsUpdateListener=()=>{this.permissionsChanged=!this.permissionsChanged},this.maybeMarkChannelAsRead=e=>{if(!this.selectedChannelId)return;if(0===e.length)return;if(-1!==this.lastReadMessageIndex)return;const t=e.at(0).time>e.at(-1).time?e.at(0):e.at(-1);t.channelIndex&&(this.lastReadMessageIndex=parseInt(t.channelIndex,10),this.meeting.chat.markLastReadMessage(this.selectedChannelId,t))},this.getChatMessages=async(e,t,i)=>{const{messages:s}=await this.meeting.chat.getMessages(e,t,i,void 0,this.selectedChannelId);return this.maybeMarkChannelAsRead(s),s},this.createChatNodes=e=>e.map(((t,i)=>{var s;const n=t.userId===(null===(s=e[i-1])||void 0===s?void 0:s.userId);return this.createChatNode(t,n)})),this.disconnectMeeting=e=>{var t,i;null===(t=null==e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.chatUpdateListener),null===(i=this.meeting)||void 0===i||i.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)},this.getMessageActions=e=>{const t=[];return this.meeting.self.permissions.pinParticipant&&t.push({id:"pin_message",label:e.pinned?this.t("unpin"):this.t("pin"),icon:this.iconPack.pin}),t},this.onMessageActionHandler=(e,t)=>{switch(e){case"pin_message":this.onPinMessage.emit(t);break;case"delete_message":this.onDeleteMessage.emit(t)}},this.createChatNode=(e,t)=>{var i,a,o,r;if(0!==e.targetUserIds.length)return null;let d;return d="CHAT"===this.meeting.meta.viewType?null===(i=this.meeting.participants.all.toArray().find((t=>t.userId===e.userId)))||void 0===i?void 0:i.picture:this.meeting.self.userId===e.userId?this.meeting.self.picture:null!==(o=null===(a=this.meeting.participants.joined.toArray().find((t=>t.userId===e.userId)))||void 0===a?void 0:a.picture)&&void 0!==o?o:null===(r=this.meeting.participants.waitlisted.toArray().find((t=>t.userId===e.userId)))||void 0===r?void 0:r.picture,(0,s.h)("div",{class:{pinned:e.pinned}},(0,s.h)("div",{class:"message-wrapper"},(0,s.h)("dyte-message-view",{time:e.time,actions:this.getMessageActions(e),authorName:e.displayName,avatarUrl:d,hideAuthorName:t,viewType:"incoming",variant:"bubble",onAction:t=>this.onMessageActionHandler(t.detail,e)},(0,s.h)("div",null,(0,s.h)("div",{class:"body"},"text"===e.type&&(0,s.h)("dyte-text-message-view",{text:e.message,isMarkdown:!0}),"file"===e.type&&(0,s.h)("dyte-file-message-view",{name:e.name,url:e.link,size:e.size}),"image"===e.type&&(0,s.h)("dyte-image-message-view",{url:e.link,onPreview:()=>{this.stateUpdate.emit({image:e}),n.s.image=e}})),e.pinned&&(0,s.h)("div",{class:"pin-icon",part:"pin-icon"},(0,s.h)("dyte-icon",{icon:this.iconPack.pin,iconPack:this.iconPack,t:this.t,size:"sm"}))))))},this.chatUpdateListener=e=>{this.selectedChannelId&&e.message.channelId!==this.selectedChannelId||("add"===e.action?(this.$paginatedListRef.onNewNode(e.message),this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead([e.message])):"delete"===e.action?this.$paginatedListRef.onNodeDelete(e.message.id):"edit"===e.action&&this.$paginatedListRef.onNodeUpdate(e.message.id,e.message))},this.meeting=void 0,this.selectedChannel=void 0,this.selectedChannelId=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.children=void 0,this.leftAlign=!1,this.permissionsChanged=!1}componentDidLoad(){const e=this.host.shadowRoot.querySelector("slot");e&&(this.children=e.assignedElements()[0])}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;null!=t&&this.disconnectMeeting(t),e&&!e.chat||(null!=e&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener),e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)),this.permissionsUpdateListener())}channelChanged(){this.lastReadMessageIndex=-1}render(){return(0,s.h)(s.H,null,(0,s.h)("dyte-paginated-list",{ref:e=>this.$paginatedListRef=e,pageSize:this.pageSize,pagesAllowed:3,fetchData:this.getChatMessages,createNodes:this.createChatNodes,selectedItemId:this.selectedChannelId,emptyListLabel:this.t("chat.empty_channel")},(0,s.h)("slot",null)))}get host(){return(0,s.a)(this)}static get watchers(){return{meeting:["meetingChanged"],selectedChannelId:["channelChanged"]}}};k.style=":host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));flex:1 0 0px}";const _=class{constructor(e){(0,s.r)(this,e),this.pageSize=50,this.searchMessages=async(e,t,i)=>this.meeting.chat.searchMessages(this.query,{channelId:this.channelId,timestamp:e,size:t,reversed:i}),this.nodeRenderer=e=>e.map((e=>(0,s.h)("dyte-chat-message",{key:e.id,message:e,disableControls:!0}))),this.meeting=void 0,this.query=void 0,this.channelId=void 0,this.iconPack=o.d,this.t=(0,r.u)()}render(){return(0,s.h)(s.H,null,(0,s.h)("dyte-paginated-list",{pageSize:this.pageSize,pagesAllowed:3,fetchData:this.searchMessages,createNodes:this.nodeRenderer,selectedItemId:this.query}))}};_.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;flex-direction:column;position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}";const C=class{constructor(e){(0,s.r)(this,e),this.stateUpdate=(0,s.c)(this,"dyteStateUpdate",7),this.updateStoreState=(e,t)=>{n.s[e]=t,this.stateUpdate.emit({[e]:t})},this.cancelJoinStage=async()=>{var e,t,i;"ACCEPTED_TO_JOIN_STAGE"===(null===(e=this.meeting.stage)||void 0===e?void 0:e.status)&&await(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i?void 0:i.leave()),this.updateStoreState("activeJoinStage",!1)},this.joinStage=async()=>{await this.meeting.stage.join()},this.stageStatusUpdateListener=e=>{var t;((null===(t=this.states)||void 0===t?void 0:t.activeJoinStage)||n.s.activeJoinStage)&&"ON_STAGE"===e&&this.updateStoreState("activeJoinStage",!1)},this.meeting=void 0,this.config=g.d,this.states=n.s,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)()}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting.stage)||void 0===e||e.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)}meetingChanged(e){if(null==e)return;const{stage:t}=e;null==t||t.addListener("stageStatusUpdate",this.stageStatusUpdateListener)}render(){var e,t,i,a;const o={meeting:this.meeting,states:this.states||n.s,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t},r=this.states||n.s;if(null!=(null==r?void 0:r.image)){const e=r.image,t=()=>{this.stateUpdate.emit({image:null}),n.s.image=null};return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:t,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-image-viewer",defaults:o,props:{image:e,onClose:t}})))}if(!0===(null==r?void 0:r.activeSettings))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeSettings",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-settings",defaults:o})));if(!0===(null==r?void 0:r.activeDebugger))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeDebugger",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-debugger",defaults:o})));if(!0===(null==r?void 0:r.activeLeaveConfirmation))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeLeaveConfirmation",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-leave-meeting",defaults:o})));if(!0===(null===(e=null==r?void 0:r.activePermissionsMessage)||void 0===e?void 0:e.enabled))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-permissions-message",defaults:o})));if(!0===(null==r?void 0:r.activeRemoteAccessManager))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeRemoteAccessManager",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-remote-access-manager",defaults:o})));if(!0===(null===(t=null==r?void 0:r.activeBreakoutRoomsManager)||void 0===t?void 0:t.active))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBreakoutRoomsManager",{active:!1,data:void 0}),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-breakout-rooms-manager",defaults:o,props:{mode:this.meeting.connectedMeetings.isActive?"view":"create"}})));if(!0===(null===(i=null==r?void 0:r.activeConfirmationModal)||void 0===i?void 0:i.active))return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeConfirmationModal",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-confirmation-modal",defaults:o})));if(!0===(null===(a=null==r?void 0:r.activeOverlayModal)||void 0===a?void 0:a.active))return(0,s.h)(s.H,null,(0,s.h)("dyte-overlay-modal",{meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t}));if(null==r?void 0:r.activeBroadcastMessageModal)return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBroadcastMessageModal",!1),iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-broadcast-message-modal",defaults:o})));if(!0===(null==r?void 0:r.activeJoinStage)){const e={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")};return(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:this.cancelJoinStage,iconPack:this.iconPack,t:this.t},(0,s.h)("dyte-join-stage",Object.assign({dataConfig:e,onDyteJoinStage:this.joinStage,onDyteLeaveStage:this.cancelJoinStage},o))))}return!0===(null==r?void 0:r.activeMuteAllConfirmation)?(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeMuteAllConfirmation",!1)},iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-mute-all-confirmation",defaults:o}))):(null==r?void 0:r.activeChannelCreator)?(0,s.h)(s.H,null,(0,s.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeChannelCreator",!1)},iconPack:this.iconPack,t:this.t},(0,s.h)(u.R,{element:"dyte-channel-creator",defaults:o}))):null}static get watchers(){return{meeting:["meetingChanged"]}}};C.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";const P=2e3,L=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0,tab_sync:!0,recording_started:!0,recording_stopped:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0,participant_joined_waitlist:!0},notification_duration:{participant_joined:2100,participant_left:2100,participant_joined_waitlist:4e3,chat:P,polls:P,webinar:P,tab_sync:P,recording_started:P,recording_stopped:P},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10});function S(e){return Object.keys(e).filter((t=>e[t]))}const j=class{constructor(e){(0,s.r)(this,e),this.permissions=L,this.enabledSounds=S(L.notification_sounds),this.addStagePeersListeners=e=>{e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener)},this.removeStagePeersListeners=e=>{e.participants.joined.removeListener("participantJoined",this.participantJoinedListener),e.participants.joined.removeListener("participantLeft",this.participantLeftListener)},this.onDyteNotification=e=>{this.add(e.detail);const t=e.detail.playSound;null!=t&&this.audio.play(t)},this.onRecordingUpdate=e=>{var t,i;"RECORDING"===e&&!1!==this.permissions.notifications.recording_started?this.add({id:"recording-started",icon:this.iconPack.recording,message:this.t("recording.started"),duration:null!==(t=this.permissions.notification_duration.recording_started)&&void 0!==t?t:P}):"STOPPING"===e&&!1!==this.permissions.notifications.recording_stopped&&this.add({id:"recording-stopped",icon:this.iconPack.stop_recording,message:this.t("recording.stopped"),duration:null!==(i=this.permissions.notification_duration.recording_stopped)&&void 0!==i?i:P})},this.meeting=void 0,this.states=void 0,this.config=g.d,this.t=(0,r.u)(),this.size=void 0,this.iconPack=o.d,this.notifications=[]}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(e){var t,i,s,n,a,o,r,d;const c="LIVESTREAM"===e.meta.viewType;(c&&"ON_STAGE"===(null===(t=e.stage)||void 0===t?void 0:t.status)||!c)&&this.removeStagePeersListeners(e),this.chatUpdateListener&&(null===(i=e.chat)||void 0===i||i.removeListener("chatUpdate",this.chatUpdateListener)),this.pollUpdateListener&&(null===(s=e.polls)||void 0===s||s.removeListener("pollsUpdate",this.pollUpdateListener)),e.meta.removeListener("socketConnectionUpdate",this.socketConnectionUpdateListener),this.stageRequestAccepted&&(null===(n=e.stage)||void 0===n||n.removeListener("stageRequestApproved",this.stageRequestAccepted)),this.stageRequestRejected&&(null===(a=e.stage)||void 0===a||a.removeListener("stageRequestRejected",this.stageRequestRejected)),this.newStageRequests&&(null===(o=e.stage)||void 0===o||o.removeListener("newStageRequest",this.newStageRequests)),this.stageStatusUpdateListener&&(null===(r=e.stage)||void 0===r||r.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)),null===(d=e.recording)||void 0===d||d.removeListener("recordingUpdate",this.onRecordingUpdate),clearTimeout(this.disconnectTimeout),e.self.removeListener("deviceUpdate",this.deviceUpdateListener)}disconnectedCallback(){var e;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.waitlistedParticipantLeftListener&&this.meeting.participants.waitlisted.removeListener("participantLeft",this.waitlistedParticipantLeftListener),this.activeTabUpdateListener&&(null===(e=this.meeting.meta)||void 0===e||e.removeListener("activeTabUpdate",this.activeTabUpdateListener)),this.peerStageStatusListener&&this.meeting.participants.joined.removeListener("stageStatusUpdate",this.peerStageStatusListener))}meetingChanged(e,t){var i,s,n,o,r,d,c,h,p;if(clearTimeout(this.disconnectTimeout),void 0!==t&&this.clearListeners(t),null==e)return;const g="LIVESTREAM"===e.meta.viewType;this.audio=new m.D(e);const{notifications:u,notification_duration:y,notification_sounds:b}=this.permissions;if(this.participantJoinedListener=e=>{u.participant_joined&&this.add({id:`${e.id}-joined`,message:`${(0,v.f)(e.name)} ${this.t("notifications.joined")}`,image:e.picture,duration:y.participant_joined}),b.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=e=>{const{socketState:{state:t}}=this.meeting.meta;u.participant_left&&"connected"!==t&&this.add({id:`${e.id}-left`,message:`${(0,v.f)(e.name)} ${this.t("notifications.left")}`,image:e.picture,duration:y.participant_left}),b.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=e=>{if(!this.canAcceptWaitingRequests())return;const t=`${e.id}-joined-waitlist`;this.add({id:t,message:`${(0,v.f)(e.name)} ${this.t("notifications.requesting_to_join_meeting")}`,image:e.picture,duration:y.participant_joined_waitlist,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(e.id),this.remove(t)}}}),b.participant_joined_waitlist&&this.canPlayParticipantJoinedSound()&&this.audio.play("message")},this.waitlistedParticipantLeftListener=e=>{this.remove(`${e.id}-joined-waitlist`)},this.chatUpdateListener=({message:t})=>{const i=(0,l.j)(t);if(null!=i){if(i.userId===e.self.userId)return;"text"===i.type&&(u.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${i.displayName}: ${i.message}`,duration:y.chat}),b.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:e,newPoll:t})=>{!1!==t&&(u.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`${this.t("notifications.new_poll_created_by")} ${e[e.length-1].createdBy}`,duration:y.polls}),b.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message"))},this.deviceUpdateListener=({device:e,preview:t})=>{t||("audiooutput"===e.kind&&(this.audio.setDevice(e.deviceId),this.remove("speaker-switched"),this.add({id:"speaker-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.iconPack.speaker,duration:5e3})),"videoinput"===e.kind&&(this.remove("camera-switched"),this.add({id:"camera-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.meeting.self.videoEnabled?this.iconPack.video_on:this.iconPack.video_off,iconVariant:this.meeting.self.videoEnabled?"primary":"danger",duration:5e3})),"audioinput"===e.kind&&(this.remove("mic-switched"),this.add({id:"mic-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.meeting.self.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off,iconVariant:this.meeting.self.audioEnabled?"primary":"danger",duration:5e3})))},this.socketConnectionUpdateListener=({state:e,reconnectionAttempt:t,reconnected:i})=>{switch(e){case"connected":this.remove("socket"),i&&this.add({id:"socket",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3});break;case"disconnected":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.reconnecting")});break;case"reconnecting":t>=6?(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.disconnected"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})):t>=4&&(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.delay_extended")}));break;case"failed":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.leaving"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})}},this.activeTabUpdateListener=t=>{if(u.tab_sync)switch(t.type){case"plugin":const i=e.plugins.active.toArray().find((e=>e.id==t.id));null!=i&&this.add({id:"activeTab",message:`${this.t("notifications.plugin_switched_to")} ${i.name}`,duration:y.participant_joined});break;case"screenshare":const s=e.participants.joined.toArray().filter((e=>e.screenShareEnabled)).find((e=>e.id==t.id));null!=s&&this.add({id:"spotlight",message:`Now watching ${s.name}'s screen`,duration:y.webinar})}},this.peerStageStatusListener=e=>{"REQUESTED_TO_JOIN_STAGE"===e.stageStatus&&(this.add({id:`stage-request-${e.id}`,message:`${e.name} ${this.t("notifications.requested_to_join_stage")}`,duration:y.webinar,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.stage.grantAccess([e.userId]),this.remove(`stage-request-${e.id}`)}}}),b.webinar&&this.audio.play("joined")),"ON_STAGE"===e.stageStatus&&(this.add({id:`stage-joined-${e.id}`,message:`${e.name} ${this.t("notifications.joined_stage")}`,duration:y.webinar}),b.webinar&&this.audio.play("joined"))},this.stageRequestAccepted=()=>{this.add({id:"stage-request-accepted",message:this.t("notifications.request_to_join_accepted"),duration:3e3})},this.stageRequestRejected=()=>{this.add({id:"stage-request-rejected",message:this.t("notifications.request_to_join_rejected"),duration:3e3})},this.newStageRequests=({count:e})=>{this.add({id:"new-stage-request",message:`You have ${e<0?"new stage":`${e} pending`} request${1===e?"":"s"}`,duration:3e3})},this.stageStatusUpdateListener=t=>{"ON_STAGE"===t?this.addStagePeersListeners(e):this.removeStagePeersListeners(e)},!(0,a.s)(e)&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener)),"CHAT"===(null===(s=e.self.config.viewType)||void 0===s?void 0:s.toString()))return;const f=e.self.getCurrentDevices();null!=f.speaker&&this.audio.setDevice(f.speaker.deviceId),g?null===(n=e.stage)||void 0===n||n.on("stageStatusUpdate",this.stageStatusUpdateListener):this.addStagePeersListeners(e),this.canAcceptWaitingRequests()&&(e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),e.participants.waitlisted.addListener("participantLeft",this.waitlistedParticipantLeftListener)),null===(o=e.polls)||void 0===o||o.addListener("pollsUpdate",this.pollUpdateListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener),e.meta.addListener("socketConnectionUpdate",this.socketConnectionUpdateListener),null===(r=e.meta)||void 0===r||r.addListener("activeTabUpdate",this.activeTabUpdateListener),null===(d=e.recording)||void 0===d||d.addListener("recordingUpdate",this.onRecordingUpdate),null===(c=e.stage)||void 0===c||c.addListener("stageRequestApproved",this.stageRequestAccepted),null===(h=e.stage)||void 0===h||h.addListener("stageRequestRejected",this.stageRequestRejected),e.self.permissions.stageEnabled&&e.self.permissions.acceptStageRequests&&(null===(p=e.stage)||void 0===p||p.addListener("newStageRequest",this.newStageRequests))}configChanged(e){null!=e&&null!=(null==e?void 0:e.config)&&(this.permissions=function(e){const t=Object.assign({},L);return null==e||(Object.assign(t.notification_sounds,e.notification_sounds),Object.assign(t.notifications,e.notifications),Object.assign(t.notification_duration,e.notification_duration),t.participant_chat_message_sound_notification_limit=e.participant_chat_message_sound_notification_limit,t.participant_joined_sound_notification_limit=e.participant_joined_sound_notification_limit),t}(e.config),this.enabledSounds=S(this.permissions.notification_sounds))}statesChanged(e){var t;if(null!=e){const i=!(null===(t=null==e?void 0:e.prefs)||void 0===t?void 0:t.muteNotificationSounds);for(const e of this.enabledSounds)e in this.permissions.notification_sounds&&(this.permissions.notification_sounds[e]=i)}}apiErrorListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:P,icon:this.iconPack.warning})}sendNotificationListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:P})}add(e){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,e])}remove(e){this.notifications=this.notifications.filter((t=>t.id!==e))}handleDismiss(e){e.stopPropagation();const t=e.detail,i=this.host.shadowRoot.querySelector(`[data-id="${t}"]`);null==i||i.classList.add("exit"),setTimeout((()=>{(0,s.w)((()=>{this.remove(t)}))}),400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_joined_sound_notification_limit||this.permissions.participant_joined_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_joined_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return(0,s.h)(s.H,null,this.notifications.map((e=>(0,s.h)("dyte-notification",{size:this.size,key:e.id,"data-id":e.id,notification:e,onDyteNotificationDismiss:e=>this.handleDismiss(e),iconPack:this.iconPack,t:this.t}))))}get host(){return(0,s.a)(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};j.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;z-index:100}dyte-notification{margin-top:var(--dyte-space-2, 8px)}"},17213:(e,t,i)=>{i.d(t,{R:()=>d,l:()=>r});var s=i(72944);const n=({element:e,size:t,states:i={},config:s={}})=>{let n=[];const a=null==s?void 0:s.root[e],o=e=>{n.push(e),"string"==typeof t&&n.push(`${e}.${t}`)};if(o(e),"object"==typeof a&&!Array.isArray(a)&&null!==a){const{state:t,states:s}=a;let n=e,r=[];if(Array.isArray(s)){r=s.filter((e=>i[e])),r.sort();for(const e of r)o(`${n}.${e}`);if(r.length>1){o([n,...r].join("."))}}if("string"==typeof t){const s=`${e}[${t}=${i[t]}]`;o(s);for(const e of r)o(`${s}.${e}`);if(r.length>1){o([s,...r].join("."))}}}return n},a=({selectors:e,root:t})=>{if(!t||!Array.isArray(e))return[];let i=[];for(const s of e){const e=t[s];if(Array.isArray(e))i=[...e];else if(e){if(e.children&&(i=[...e.children]),Array.isArray(e.remove))for(const t of e.remove)i=i.filter((e=>"string"==typeof e?e!==t:!Array.isArray(e)||e[0]!==t));if(e.addBefore)for(const[t,s]of Object.entries(e.addBefore)){const e=i.findIndex((e=>"string"==typeof e?e===t:!!Array.isArray(e)&&e[0]===t));e>=0&&i.splice(e,0,...s)}Array.isArray(e.add)&&(i=i.concat(e.add)),Array.isArray(e.prepend)&&(i=e.prepend.concat(i))}}return i},o=({elements:e,defaults:t,props:i={},deepProps:n=!1,elementProps:a={}})=>Array.isArray(e)&&0!==e.length?e.map((e=>(0,s.h)(d,{element:e,defaults:t,props:i,childProps:n&&i,elementProps:a}))):null,r=({element:e,defaults:t,props:i={},elementProps:s={}})=>{var o;const{config:r,size:d,states:c}=t;let l,h={},p=[];Array.isArray(e)?[l,h,...p]=e:l=e;const g=null===(o=null==r?void 0:r.root)||void 0===o?void 0:o[l];null!=g&&"props"in g&&(i=Object.assign(Object.assign({},g.props),i)),i=Object.assign(Object.assign({},i),h),l in s&&(i=Object.assign(Object.assign({},i),s[l]));const u=n({element:l,size:d,states:c,config:r});return a({selectors:u,root:r.root}).length},d=({element:e,defaults:t,childProps:i={},props:r={},onlyChildren:d=!1,asHost:c=!1,deepProps:l=!1,elementProps:h={}},p)=>{var g;const{config:u,size:m,states:v}=t;let y,b={},f=[];Array.isArray(e)?[y,b,...f]=e:y=e;const w=null===(g=null==u?void 0:u.root)||void 0===g?void 0:g[y];null!=w&&"props"in w&&(r=Object.assign(Object.assign({},w.props),r)),r=Object.assign(Object.assign({},r),b),y in h&&(r=Object.assign(Object.assign({},r),h[y]));const x=n({element:y,size:m,states:v,config:u}),k=a({selectors:x,root:u.root});if(d)return(0,s.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h});const _=(({selectors:e,styles:t})=>{if(!Array.isArray(e)||null==t)return{};const i={};for(const s of e){const e=t[s];null!=e&&Object.assign(i,e)}return i})({selectors:x,styles:u.styles});if(c)return(0,s.h)(s.H,Object.assign({},t,{style:_},r),(0,s.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),p,f.map((e=>{if(Array.isArray(e)){const[i,n]=e;return(0,s.h)(i,Object.assign({},t,n))}return e})));if(["dyte-header","dyte-controlbar"].includes(y)&&(r.disableRender=!0),y.startsWith("dyte-"))return(0,s.h)(y,Object.assign({},t,{style:_},r),(0,s.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),p,f.map((e=>{if(Array.isArray(e)){const[i,n]=e;return(0,s.h)(i,Object.assign({},t,n))}return e})));{const[e,n]=y.split("#");return(0,s.h)(e,Object.assign({id:n,style:_},r),(0,s.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),p,f.map((e=>{if(Array.isArray(e)){const[i,n]=e;return(0,s.h)(i,Object.assign({},t,n))}return e})))}}},32599:(e,t,i)=>{i.d(t,{s:()=>s});const s=(e,t=!0)=>{null!=e&&e.scrollTo({top:e.scrollHeight,behavior:t?"smooth":"auto"})}},1821:(e,t,i)=>{i.d(t,{a:()=>a,f:()=>o,g:()=>c,h:()=>n,s:()=>s});const s=(e,t=20)=>null==e?"":e.length>t?`${e.substring(0,t)}...`:e,n=e=>/^\p{Emoji}+$/u.test(e)&&!/^\d+$/.test(e),a=e=>(null==e?void 0:e.trim().toLowerCase().startsWith("javascript:"))?"https://dyte.io":e,o=e=>""===(e=null==e?void 0:e.trim())?"Participant":e,r=new RegExp(/[^\u00BF-\u1FFF\u2C00-\uD7FF\w\s]/,"g"),d=new RegExp(/\s+/);function c(e,t=2){return e.replace(r,"").trim().split(d).slice(0,t).map((e=>e.charAt(0))).join("").toUpperCase()}}}]);